# Changelog

All notable changes to this project will be documented in this file
automatically by Versionist. DO NOT EDIT THIS FILE MANUALLY!
This project adheres to [Semantic Versioning](http://semver.org/).

# v0.13.4
## (2026-01-22)

* Improve safe_write_all [felipe]

# v0.13.3
## (2026-01-22)

* Refactor Image model to have an optional engine id [felipe]
* Add download_progress field to Worker images [felipe]
* Add `pull_with_progress` method to helios_oci::Image [felipe]
* Use mahler View::create and View::delete method in tasks [felipe]
* Update mahler to v0.24.1 [felipe]

# v0.13.2
## (2026-01-16)

* Recreate the worker before applying state [felipe]
* Process image installs for all apps [felipe]
* Use ImageRef type to reference local images [felipe]
* Read/write service data from containers [felipe]
* Create ServiceContainerName type [felipe]
* Read/write app metadata from local store [felipe]

# v0.13.1
## (2025-12-09)

* Update mahler to v0.22 [felipe]

# v0.13.0
## (2025-12-05)

* Use host runtime dir on balenahup tasks [felipe]
* Add host-runtime-dir option to CLI [felipe]
* Group state initialization into a `prepare` function [felipe]
* Create tar module in utils [felipe]

# v0.12.0
## (2025-11-27)

* Disable hostapp reporting [felipe]
* Refactor device host model [felipe]
* Add hostapp reporting [felipe]
* Implement HostOS update tasks [felipe]
* Split helios-state/worker tasks into separate tasks module [felipe]
* Parse build identifier in the OperatingSystem type [felipe]
* Refactor integration tests to test utils [felipe]
* Add systemd module in helios-util [felipe]
* Update models to work with mahler@0.21.4 [felipe]
* Add initial HostApp model [felipe]
* Make features configurable on Docker build [felipe]
* Make /v3 API endpoints an optional feature of helios-api [felipe]
* Create `userapps` and `balenahup` features in helios-state [felipe]

# v0.11.6
## (2025-10-12)

* Rename Store::store to Store::write [felipe]
* Read device name from local store [felipe]
* Use a Store instance for loading config and provisioning [felipe]
* Implement `store` module in helios-util [felipe]
* Make helios-util config functions async [felipe]

# v0.11.5
## (2025-10-04)

* Remove helios-remote-types dependency on helios-oci [felipe]
* Use remote_input::AppTarget for local API [felipe]
* Create helios-remote-types with validation types [felipe]

# v0.11.4
## (2025-10-03)

* Rename integration folder to `helios-integration-tests` [felipe]

# v0.11.3
## (2025-10-01)

* Do not validate target release count [felipe]
* Stop checking digest tag [felipe]
* Remove support for config vars [felipe]
* Statically build Regex for ImageUri [felipe]
* Omit the `latest` tag when parsing image Uris [felipe]
* Send empty report [felipe]

# v0.11.2
## (2025-09-26)

* Fix registry auth initialization [felipe]

# v0.11.1
## (2025-09-26)

* Create build script for helios-util crate [felipe]

# v0.11.0
## (2025-09-25)

* Bump Rust version to 1.87 and edition to 2024 [Akis Kesoglou]
* Move helios main to a new crate [Akis Kesoglou]
* Move helios-api to a new crate [Akis Kesoglou]
* Move helios-remote to a new crate [Akis Kesoglou]
* Move helios-state to a new crate [Akis Kesoglou]
* Move helios-legacy to a new crate [Akis Kesoglou]
* Move helios-oci to a new crate [Akis Kesoglou]
* Improve registry configuration [Akis Kesoglou]
* Move types into helios-util [Akis Kesoglou]
* Move config into helios-util [Akis Kesoglou]
* Move helios-util to a new crate [Akis Kesoglou]

# v0.10.1
## (2025-09-23)

* Move all use of Bollard into a new module [Akis Kesoglou]
* Move Registry into OCI module [Akis Kesoglou]
* Move Request into utils [Akis Kesoglou]
* Move ImageUri into a new module [Akis Kesoglou]

# v0.10.0
## (2025-09-04)

* Ignore HELIOS_REMOTE_* credentials in the container [felipe]
* Read host OS version from CLI [felipe]
* Refactor Host type into OperatingSystem [felipe]

# v0.9.2
## (2025-09-02)

* Fix setup-supervisor script to use latest CLI config [felipe]

# v0.9.1
## (2025-09-02)

* Update README with project goals and architecture [felipe]

# v0.9.0
## (2025-08-29)

* Use BTreeMap rather than HashMap for models [felipe]
* Add clean-up tasks [felipe]
* Add registry credentials management [felipe]
* Add task to fetch service image. [Felipe Lalanne]
* Add task to tag image [Felipe Lalanne]
* Add image pull/remove tasks to worker [felipe]
* Create docker::ImageUri type to handle URI manipulation [felipe]
* Use shared docker connection [Felipe Lalanne]

# v0.8.0
## (2025-08-04)

* Remove POST /v3/device API endpoint [Felipe Lalanne]
* Read device state from docker engine [Felipe Lalanne]
* Ignore hostapps when deserializing target state [Felipe Lalanne]

# v0.7.2
## (2025-08-01)

* Set-up docker volume for configuration data [Felipe Lalanne]

# v0.7.1
## (2025-07-31)

* Make Uri a new serializable type [Akis Kesoglou]

# v0.7.0
## (2025-07-30)

* Make clear that proxy’s configured UUID is legacy’s UUID [Akis Kesoglou]
* Make proxy config legacy URI non-optional [Akis Kesoglou]
* Implement device provisioning [Akis Kesoglou]
* Make API keys a new type [Akis Kesoglou]
* Make utility digest function [Akis Kesoglou]

# v0.6.2
## (2025-07-29)

* Add some worker tests [Felipe Lalanne]

# v0.6.1
## (2025-07-25)

* Make get/patch interrupt an Option [Felipe Lalanne]
* Remove `performing action` logs [Felipe Lalanne]
* Make poll request interruptible [Felipe Lalanne]
* Make Get request error reporting consistent with patch [Felipe Lalanne]
* Add interrupt signal to request Patch [Felipe Lalanne]

# v0.6.0
## (2025-07-24)

* Add Start command [Akis Kesoglou]
* Use CLI directly for all configuration [Akis Kesoglou]

# v0.5.0
## (2025-07-24)

* Split proxy into config and state cache parts [Akis Kesoglou]
* Rename “fallback” to “legacy” [Akis Kesoglou]
* Break up fallback into submodules [Akis Kesoglou]
* Turn fallback into a submodule [Akis Kesoglou]

# v0.4.11
## (2025-07-24)

* Flesh out the CLI providing defaults and encoding dependencies between arguments [Akis Kesoglou]
* Stop carrying Config around and forward only necessary values [Akis Kesoglou]
* Move register into remote [Akis Kesoglou]

# v0.4.10
## (2025-07-23)

* Fix the order of query/sleep in wait_for_state [Felipe Lalanne]
* Update dependencies [Felipe Lalanne]

# v0.4.9
## (2025-07-23)

* Add Interrupt argument to fallback functions [Felipe Lalanne]
* Wait for fallback state to settle on the seek loop [Felipe Lalanne]
* Split wait for settle step from legacy_update fn [Felipe Lalanne]

# v0.4.8
## (2025-07-23)

* Add API tests [Felipe Lalanne]
* Split seek and report into separate loops [Felipe Lalanne]
* Rename TargetStatus to UpdateStatus, move to seek.rs [Felipe Lalanne]

# v0.4.7
## (2025-07-22)

* Break up main poll loop into separate actions [Akis Kesoglou]

# v0.4.6
## (2025-07-22)

* Break up main seek loop into separate actions [Akis Kesoglou]

# v0.4.5
## (2025-07-21)

* Merge state/poll with remote/poll [Akis Kesoglou]
* Split poll and report into separate modules [Akis Kesoglou]
* Split poll and seek handling into separate modules [Akis Kesoglou]
* Split Poll and Seek variants of UpdateRequest [Akis Kesoglou]

# v0.4.4
## (2025-07-21)

* Hash URL for calculating cache filename [Felipe Lalanne]
* Modify UpdateOpts to cancel by default [Felipe Lalanne]
* Write/read GET request cache on disk [Felipe Lalanne]

# v0.4.3
## (2025-07-20)

* Rename SupervisorError to CoreError [Felipe Lalanne]
* Split state module into state/worker/models [Felipe Lalanne]

# v0.4.2
## (2025-07-18)

* Split the main loop into poll and seek/report [Felipe Lalanne]
* Re-set back-off timer on new get/patch requests [Felipe Lalanne]

# v0.4.1
## (2025-07-18)

* Refactor update request management [Felipe Lalanne]
* Group target apply calls into a function [Felipe Lalanne]
* Fix busy waiting on worker stream [Felipe Lalanne]
* Reset the poll time after triggering new poll [Felipe Lalanne]

# v0.4.0
## (2025-07-16)

* Use socket rather than host networking [Felipe Lalanne]
* Add configuration option to listen from Unix socket [Felipe Lalanne]

# v0.3.5
## (2025-07-16)

* Make state endpoint request helpers private to remote module [Akis Kesoglou]

# v0.3.4
## (2025-07-16)

* Streamline CLI and config loading [Akis Kesoglou]

# v0.3.3
## (2025-07-15)

* Streamline update options [Akis Kesoglou]

# v0.3.2
## (2025-07-14)

* Fix intrumentation call hierarchy [Felipe Lalanne]

# v0.3.1
## (2025-07-14)

* Fix the reset_interval function on the request module [Felipe Lalanne]
* Improve instrumentation of poll_remote/send_report functions [Felipe Lalanne]

# v0.3.0
## (2025-07-14)

* Add target apply endpoints [Felipe Lalanne]
* Set-up integration tests [Felipe Lalanne]
* Create GET /v3/device API endpoint [Felipe Lalanne]
* Fix early exit in scripts/start-supervisor.sh [Felipe Lalanne]

# v0.2.10
## (2025-07-11)

* Remove the need for legacy db volume [Felipe Lalanne]
* Configure startup based on variable availability [Felipe Lalanne]

# v0.2.9
## (2025-07-10)

* Drop `hyper` and related dependencies [Akis Kesoglou]

# v0.2.8
## (2025-07-10)

* Separate remote handling code from target state handling [Akis Kesoglou]
* Drop `anyhow` dep and perform actual error handling/propagation [Akis Kesoglou]
* Move a few things around [Akis Kesoglou]

# v0.2.7
## (2025-07-08)

* Simplify start script [Felipe Lalanne]

# v0.2.6
## (2025-07-07)

* Refactor tracing instrumentation [Felipe Lalanne]
* Remove Overrides module [Felipe Lalanne]

# v0.2.5
## (2025-07-07)

* Cleanup main loop [Felipe Lalanne]
* Refactor code [Felipe Lalanne]
* Wait for legacy update to settle before continuing poll loop [Felipe Lalanne]
* Set-up mahler [Felipe Lalanne]

# v0.2.4
## (2025-07-03)

* Remove unecessary module nesting [Akis Kesoglou]
* Refactor Supervisor API server [Akis Kesoglou]

# v0.2.3
## (2025-07-01)

* Refactor all fallback utils into its own module [Felipe Lalanne]

# v0.2.2
## (2025-06-30)

* Move caching fields from RequestState to Get struct [Felipe Lalanne]
* Simplify Patch struct to use blocking interface like Get [Felipe Lalanne]

# v0.2.1
## (2025-06-30)

* Rename ghcr package to 'helios' [Felipe Lalanne]

# v0.2.0
## (2025-06-30)

* Bind to local port before starting poll [Felipe Lalanne]
* Rename the project to Helios and update README [Felipe Lalanne]
* Simplify the main service loop [Felipe Lalanne]
* Setup layered configuration approach [Felipe Lalanne]
* Handle /v1/update requests [Felipe Lalanne]
* Make remote api endpoint optional [Felipe Lalanne]
* Make fallback address optional [Felipe Lalanne]
* Use Clap for parsing arguments and env vars [Felipe Lalanne]

# v0.1.0
## (2025-06-26)

* Add target state overrides system [Felipe Lalanne]
* Implement target state caching and interception in proxy [Felipe Lalanne]
* Add uplink service for target state polling [Felipe Lalanne]
* Add HTTP client functionality [Felipe Lalanne]
* Refactor configuration [Felipe Lalanne]

# v0.0.3
## (2025-06-16)

* Refactor code and rename repository [Felipe Lalanne]

# v0.0.2
## (2025-06-16)

* Setup flowzone [Felipe Lalanne]
